@using WorkFlow.DAL.Data;
@using PagedList.Mvc;
@using HRM.DAL.Util;
@using WorkFlow.DAL;
@model PagedList.IPagedList<bpm_vendor>
@using PagedList.Mvc;
@{
    ViewBag.Title = "Manage Vendors";
}


<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-sm-4">
        <h2>Vendors</h2>
        <ol class="breadcrumb">
            <li>
                <a href="@Url.Action("Noticeboard","Admin")">Administration</a>
            </li>
            <li>
                <a href="#">Workflow</a>
            </li>
            <li class="active">
                <strong>Vendors</strong>
            </li>
        </ol>
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="wrapper wrapper-content animated fadeInUp">

            <div class="ibox">
                <div class="ibox-title">
                    <h5>All Vendors</h5>
                    <div class="ibox-tools">
                        <button type="button" data-toggle="modal" data-target="#myModal2" class="btn btn-primary btn-xs">Add Vendor</button>
                    </div>
                </div>
                <div class="ibox-content">
                    <div class="row m-b-sm m-t-sm">
                        <div class="col-md-1">
                            <button type="button" id="loading-example-btn" class="btn btn-white btn-sm"><i class="fa fa-refresh"></i> Refresh</button>
                        </div>
                        <div class="col-md-11">
                            <form action="@Url.Action("Vendors","Vendor")" method="get">
                                <div class="input-group">

                                    <input type="text" name="search" placeholder="Search" class="input-sm form-control"> <span class="input-group-btn">
                                        <button type="submit" class="btn btn-sm btn-primary"> Go!</button>
                                    </span>

                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="project-list">
                        <div class="table-responsive">
                            <table class="table table-bordered ">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Name</th>
                                        <th>Company Name</th>
                                        <th>Address</th>
                                        <th>Email</th>
                                        <th>Phone</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>

                                @if (Model.Any())
                                {
                                    var count = 0;
                                    foreach (var vendor in Model)
                                    {
                                        count++;
                                        <tr>
                                            <td>@count</td>
                                            <td><strong><a href="@Url.Action("Manage","Vendor",new { id = vendor.id })">@vendor.name</a> </strong></td>
                                            <td>@vendor.company_name</td>
                                            <td>@vendor.address</td>
                                            <td>
                                                @vendor.email
                                            </td>
                                            <td>@vendor.phone</td>
                                            <td>
                                                <a onclick="deleteVendor(@vendor.id)" class="btn btn-xs btn-danger"><icon class="fa fa-trash"></icon></a>
                                            <td>
                                        </tr>
                                    }
                                }

                                </tbody>
                            </table>
                        </div>

                        <div id='Paging' style="text-align:center">
                            Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber)
                            of @Model.PageCount

                            @Html.PagedListPager(Model, page => Url.Action("vendors", new { page }))
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal inmodal" id="myModal2" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        @using (Html.BeginForm("Vendors", "Vendor", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
        {
            <div class="modal-content animated flipInY">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">Add a Vendor</h4>

                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="col-lg-3 control-label">Name</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="name" required 
                                   data-toggle="tooltip" data-placement="top" title="Enter the name of the vendor" />
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Company name</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="company_name" required
                                   data-toggle="tooltip" data-placement="top" title="Enter the name of the vendor's Company"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Address</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="address" required 
                                   data-toggle="tooltip" data-placement="top" title="Enter the address of the vendor's Company"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Email</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="email" 
                                   data-toggle="tooltip" data-placement="top" title="Enter the email of the vendor's Company"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Phone</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="phone" maxlength="20" required 
                                   data-toggle="tooltip" data-placement="top" title="Enter the phone number of the vendor" />
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">TIN</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="tin"
                                   data-toggle="tooltip" data-placement="top" title="Enter the Tax Identification Number of the vendor"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Account Number</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="account_number" 
                                   data-toggle="tooltip" data-placement="top" title="Enter the Bank Account number of the vendor"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Account Name</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="account_name" 
                                   data-toggle="tooltip" data-placement="top" title="Enter the Bank account name of the vendor"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Bank Name</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="bank_name" 
                                   data-toggle="tooltip" data-placement="top" title="Enter the name of the vendor's bank"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">RC Number</label>

                        <div class="col-lg-9">
                            <input type="text" class="form-control" name="rc_number" 
                                   data-toggle="tooltip" data-placement="top" title="Enter the vendor's registration number"/>
                        </div>
                    </div>

                    <div class="form-group" data-toggle="tooltip" data-placement="top" title="Select the categories the vendor offers, You can select more than one">
                        <label class="col-lg-3 control-label">Category</label>

                        <div class="col-lg-9">
                            @*@Html.DropDownList("category", new SelectList(Util.GetVendorCategories(), "id", "name", null), null, new { @class = "form-control", @multiple = "multiple" })*@
                            @*<div class="button-group">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                Select Vendors Category
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                @foreach (var category in Util.GetVendorCategories())
                {
                    <li><a href="#" class="small" data-value="@category.id" tabIndex="-1"><input type="checkbox" />&nbsp;@category.name</a></li>
                }
            </ul>
        </div>*@
                            @foreach (var category in Util.GetVendorCategories())
                            {
                                <input type="checkbox" name="category" value="@category.id">@category.name<br>
                            }
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                    <button type="submit" id="btn_submit" class="btn btn-primary">Submit</button>
                </div>
            </div>

        }
    </div>
</div>



@section scripts{

    <script src="~/Content/libs/iCheck/icheck.min.js"></script>
    <script src="~/Scripts/custom_fns/base.js"></script>

    <script>

       $(document).ready(function () {

           $('.i-checks').iCheck({
               checkboxClass: 'icheckbox_square-green',
               radioClass: 'iradio_square-green'
           });

       });

       $(function() {
           $('[data-toggle="tooltip"]').tooltip()
       });

        /*
         * Added by Johnbosco
         */
        function deleteVendor(vendorId) {
            if (confirm("Are you sure you want to delete the selected vendor?")) {
                $.post("DeleteVendor?id=" + vendorId,null, function(data, status) {
                    alert(data);
                    window.location.reload();
                });
            }
        }

    </script>
}



@section styles{
    <link href="~/Content/libs/iCheck/custom.css" rel="stylesheet" />



}






