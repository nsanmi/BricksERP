@using WorkFlow.DAL.Data
@using System.Xml.Linq;
@using HRM.DAL.Util
@using WorkFlow.DAL;
@{
                /**/

                var workflow = (bpm_workflow)ViewBag.workflow;
                var definition = workflow.workflow;
                var form = XElement.Parse(workflow.workflow).Element("form");
                var step = (Step)ViewBag.step;
                var procuremenetUnits = OptionUtil.GetProcuremenetUnits();
}
<div class="form-group">
    <table class="table table-bordered" id="tb_items">
        <thead>
            <tr>
                <th style="background-color:transparent" width="12%">Qty</th>
                <th style="background-color:transparent" width="20%">Unit</th>
                <th style="background-color:transparent" width="33%">Description</th>
                <th style="background-color:transparent" width="15%">Unit Cost</th>
                <th style="background-color:transparent" width="15%">Total</th>
                <th style="background-color: transparent" width="5%">
                    <button type="button" class="btn btn-sm btn-primary" onclick="add_row('tb_items')"><i class="fa fa-plus"></i></button>
                </th>
            </tr>
        </thead>
        <tbody>
            @if (form.Element("items").Elements("item").Any())
            {
                var count = 0;
                foreach (var item in form.Element("items").Elements("item"))
                {
                    count++;
                    <tr class="txtMult">
                        <td><input class="form-control number allownumericwithdecimal val2" type="text" required onpaste="return false" name="quantity" value="@item.Element("quantity").Value" /></td>
                        <td>
                            @Html.DropDownList("unit", new SelectList(procuremenetUnits, "lookup_name", "lookup_name", item.Element("unit").Value), "- Select -", new { @class = "form-control", @required = "required" })
                        </td>
                        <td><textarea class="form-control" required name="description" rows="2">@item.Element("description").Value</textarea></td>
                        <td><input class="form-control number val3 allownumericwithdecimal" type="text" required onpaste="return false" name="unit_cost" value="@item.Element("est_unit_cost").Value" /></td>
                        <td><span class="multTotal">@(int.Parse(@item.Element("est_unit_cost").Value) * int.Parse(@item.Element("quantity").Value))</span></td>
                        <td><button class="btn btn-sm btn-danger" type="button" onclick="delete_row(this,'tb_items')"><i class="fa fa-trash"></i></button></td>
                    </tr>
                }
            }
            else
            {
                <tr class="txtMult">
                    <td><input class="form-control number allownumericwithdecimal val2" required type="text" name="quantity" onpaste="return false" /></td>
                    <td>
                        @Html.DropDownList("unit", new SelectList(procuremenetUnits, "lookup_name", "lookup_name", null), "- Select -", new { @class = "form-control", @required = "required" })
                    </td>
                    <td><textarea class="form-control" required name="description" rows="1"></textarea></td>
                    <td><input class="form-control number allownumericwithdecimal val3" required type="text" name="unit_cost" onpaste="return false" /></td>
                    <td><span class="multTotal">0.00</span></td>
                    <td><button class="btn btn-sm btn-danger" type="button" onclick="delete_row(this,'tb_items')"><i class="fa fa-trash"></i></button></td>
                </tr>
            }
        </tbody>
        <tfoot>
            <tr>
                <td colspan="4">Total</td>
                <td id="grandTotal" colspan="2">0.00</td>
            </tr>
        </tfoot>
    </table>
</div>

@{
    var justification = "";
    if (form.Element("justification") != null)
    {
        justification = form.Element("justification").Value;
    }

    var comment = "";
    if (step.Definition.Element("comments") != null)
    {
        comment = step.Definition.Element("comments").Value;
    }
    var activity_number = "";
    if (form.Element("activity_number") != null)
    {
        activity_number = form.Element("activity_number").Value;
    }
    var conversion_rate = "";
    if (form.Element("conversion_rate") != null)
    {
        conversion_rate = form.Element("conversion_rate").Value;
    }
    var requesting_office = "";
    if (form.Element("requesting_office") != null)
    {
        requesting_office = form.Element("requesting_office").Value;
    }
    var needed_by = "";
    if (form.Element("needed_by") != null)
    {
        needed_by = form.Element("needed_by").Value;
    }
    var country = "";
    if (form.Element("country") != null)
    {
        country = form.Element("country").Value;
    }
}
<div class="from-group">
    <label>Requesting Office</label>
    <input class="form-control" type="text" name="requesting_office" value="@requesting_office" required />
</div>
@*<div class="from-group">
        <label>Needed By</label>

        <input class="form-control" type="date" name="needed_by" value="" required />
    </div>*@
<div class="form-group" id="data_2">
    <label class="font-noraml">Needed By</label>
    <div class="input-group date">
        <span class="input-group-addon"><i class="fa fa-calendar"></i></span><input id="needed_by" name="needed_by" required type="text" readonly value="@needed_by" class="form-control">
    </div>
</div>
<input class="form-control" type="hidden" name="delivery_to" value="MGIC Store" required readonly />
<input class="form-control" type="hidden" name="delivery_address" value="Plot 784, By Gilmor Engineering, Off Life Camp - Gwarimpa Expressway, Jahi distric, Abuja" required readonly />
<input class="form-control" type="hidden" name="attention" value="Balogun Oluwashola" required readonly />
<input class="form-control" type="hidden" name="phone" value="+2348066053803" required readonly />

<div class="from-group">
    <label>City/Country</label>
    <input class="form-control" type="text" name="country" value="@country" required />
</div>
<div class="from-group">
    <label>Activity Number</label>
    <input class="form-control" type="number" name="activity_number" value="@activity_number" required />
</div>

<div class="from-group">
    <label>Conversion rate</label>
    <div class="input-group date">
        <span class="input-group-addon">
            <i class="fa">&#8358</i>
        </span>
        <input id="conversion_rate" name="conversion_rate" required type="number" value="@conversion_rate" class="form-control">
    </div>
</div>
<div class="form-group">
    <label>Justification for the request</label>
    <textarea class="form-control" required name="justification">@justification
</textarea>
</div>
@*<div class="form-group">
        <label>Upload Supporting Document</label>

        <input type="file" multiple name="files" />
    </div>*@
<div class="form-group">
    <label>Additional Comments</label>
    <textarea class="form-control" name="comment">@comment</textarea>
</div>
<input type="file" name="files" multiple />
<div class="form-group">
    <label>Upload Supporting Document</label>
</div>
<div class="file-loading">
    @*<input id="file-0b" name="file-0b" class="file"  multiple type="file" data-min-file-count="1">*@
</div>





